# Secure Hierarchical Federated Learning in Vehicular Networks Using Dynamic Client Selection and Anomaly Detection

Hierarchical Federated Learning (HFL) faces the significant challenge of adversarial or unreliable vehicles in vehicular networks, which can compromise the model's integrity through misleading updates. Addressing this, our study introduces a novel framework that integrates dynamic vehicle selection and robust anomaly detection mechanisms, aiming to optimize participant selection and mitigate risks associated with malicious contributions. Our approach involves a comprehensive vehicle reliability assessment, considering historical accuracy, contribution frequency, and anomaly records. An anomaly detection algorithm is utilized to identify anomalous behavior by analyzing the cosine similarity of local or model parameters during the federated learning (FL) process. These anomaly records are then registered and combined with past performance for accuracy and contribution frequency to identify the most suitable vehicles for each learning round. Dynamic client selection and anomaly detection algorithms are deployed at different levels, including cluster heads (CHs), cluster members (CMs), and the Evolving Packet Core (EPC), to detect and filter out spurious updates. Through simulation-based performance evaluation, our proposed algorithm demonstrates remarkable resilience even under intense attack conditions. Even in the worst-case scenarios, it achieves convergence times at 63 % as effective as those in scenarios without any attacks. Conversely, in scenarios without utilizing our proposed algorithm, there is a high likelihood of non-convergence in the FL process.

## Table of Contents
- [Introduction](#introduction)
- [Features](#features)

  ## Introduction
  Anomaly detection mechanisms have been developed against model poisoning attacks in FL to identify distinguishable differences between malicious and benign models. Dynamic client selection follows anomaly detection in FL to optimize the selection of participating vehicles for each learning round based on the output of the anomaly detection.

## Features
• We propose a novel framework to provide robust protection against security vulnerabilities for executing HFL within vehicular networks for the first time in the literature. Within this framework, vehicles form clusters to implement HFL, where a reliability score is used to identify and prioritize well-behaved vehicles for participation in the learning process. Conversely, vehicles exhibiting malicious or suspicious behavior are temporarily excluded, with their behavior reassessed after a predefined period. This strategy ensures the integrity of the learning process while promoting a high-quality, secure, collaborative learning environment. 
• We propose a novel dynamic client selection methodology integrating historical accuracy, contribution frequency, and anomaly records as key metrics for executing HFL within vehicular networks for the first time in the literature. Historical accuracy facilitates prioritizing vehicles with a demonstrated ability to cooperate reliably in the FL process. Contribution frequency assists in identifying vehicles with superior communication links and hardware, thus reducing packet loss. Anomaly records aid in identifying vehicles exhibiting minimal or no anomalous behavior. Leveraging these metrics allows us to select the most accurate and reliable vehicles for the FL process. 
• We demonstrate via extensive simulations that our proposed methodology significantly outperforms previously proposed no-clustering-based and alternative attacker detection algorithms in terms of both convergence time and resilience across various attack scenarios.
